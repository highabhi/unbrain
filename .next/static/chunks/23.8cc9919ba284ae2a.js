"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[23],{4023:function(i,o,s){s.r(o),s.d(o,{DotLottieStateMachineManager:function(){return tu}});var c,h=s(8879);s(5990),s(7571),s(1369);var l=s(8854);s(3012);var v=function(){return(v=Object.assign||function(i){for(var o,s=1,c=arguments.length;s<c;s++)for(var h in o=arguments[s])Object.prototype.hasOwnProperty.call(o,h)&&(i[h]=o[h]);return i}).apply(this,arguments)};function ct(i,o){var s={};for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&0>o.indexOf(c)&&(s[c]=i[c]);if(null!=i&&"function"==typeof Object.getOwnPropertySymbols)for(var h=0,c=Object.getOwnPropertySymbols(i);h<c.length;h++)0>o.indexOf(c[h])&&Object.prototype.propertyIsEnumerable.call(i,c[h])&&(s[c[h]]=i[c[h]]);return s}function b(i){var o="function"==typeof Symbol&&Symbol.iterator,s=o&&i[o],c=0;if(s)return s.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&c>=i.length&&(i=void 0),{value:i&&i[c++],done:!i}}};throw TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")}function _(i,o){var s="function"==typeof Symbol&&i[Symbol.iterator];if(!s)return i;var c,h,l=s.call(i),f=[];try{for(;(void 0===o||o-- >0)&&!(c=l.next()).done;)f.push(c.value)}catch(i){h={error:i}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(h)throw h.error}}return f}function L(i,o,s){if(s||2==arguments.length)for(var c,h=0,l=o.length;h<l;h++)!c&&h in o||(c||(c=Array.prototype.slice.call(o,0,h)),c[h]=o[h]);return i.concat(c||Array.prototype.slice.call(o))}(K=Z||(Z={})).Start="xstate.start",K.Stop="xstate.stop",K.Raise="xstate.raise",K.Send="xstate.send",K.Cancel="xstate.cancel",K.NullEvent="",K.Assign="xstate.assign",K.After="xstate.after",K.DoneState="done.state",K.DoneInvoke="done.invoke",K.Log="xstate.log",K.Init="xstate.init",K.Invoke="xstate.invoke",K.ErrorExecution="error.execution",K.ErrorCommunication="error.communication",K.ErrorPlatform="error.platform",K.ErrorCustom="xstate.error",K.Update="xstate.update",K.Pure="xstate.pure",K.Choose="xstate.choose",(X=G||(G={})).Parent="#_parent",X.Internal="#_internal";var f=Z.Start,d=Z.Stop,p=Z.Raise,y=Z.Send,g=Z.Cancel,m=Z.NullEvent,x=Z.Assign;Z.After,Z.DoneState;var S=Z.Log,w=Z.Init,E=Z.Invoke;Z.ErrorExecution;var O=Z.ErrorPlatform,N=Z.ErrorCustom,j=Z.Update,P=Z.Choose,I=Z.Pure,C={},D="xstate.guard";function It(i,o,s){void 0===s&&(s=".");var c=dt(i,s),h=dt(o,s);return T(h)?!!T(c)&&h===c:T(c)?c in h:Object.keys(c).every(function(i){return i in h&&It(c[i],h[i])})}function qt(i){try{return T(i)||"number"==typeof i?"".concat(i):i.type}catch{throw Error("Events must be strings or objects with a string event.type property.")}}function Yt(i,o){try{return H(i)?i:i.toString().split(o)}catch{throw Error("'".concat(i,"' is not a valid state path."))}}function dt(i,o){return"object"==typeof i&&"value"in i&&"context"in i&&"event"in i&&"_event"in i?i.value:H(i)?Nt(i):"string"!=typeof i?i:Nt(Yt(i,o))}function Nt(i){if(1===i.length)return i[0];for(var o={},s=o,c=0;c<i.length-1;c++)c===i.length-2?s[i[c]]=i[c+1]:(s[i[c]]={},s=s[i[c]]);return o}function ht(i,o){for(var s={},c=Object.keys(i),h=0;h<c.length;h++){var l=c[h];s[l]=o(i[l],l,i,h)}return s}function se(i,o,s){var c,h,l={};try{for(var f=b(Object.keys(i)),d=f.next();!d.done;d=f.next()){var p=d.value,y=i[p];s(y)&&(l[p]=o(y,p,i))}}catch(i){c={error:i}}finally{try{d&&!d.done&&(h=f.return)&&h.call(f)}finally{if(c)throw c.error}}return l}var Pe=function(i){return function(o){var s,c,h=o;try{for(var l=b(i),f=l.next();!f.done;f=l.next())h=h[f.value]}catch(i){s={error:i}}finally{try{f&&!f.done&&(c=l.return)&&c.call(l)}finally{if(s)throw s.error}}return h}};function jt(i){return i?T(i)?[[i]]:M(Object.keys(i).map(function(o){var s=i[o];return"string"==typeof s||s&&Object.keys(s).length?jt(i[o]).map(function(i){return[o].concat(i)}):[[o]]})):[[]]}function M(i){var o;return(o=[]).concat.apply(o,L([],_(i),!1))}function z(i){return void 0===i?[]:H(i)?i:[i]}function ot(i,o,s){if(A(i))return i(o,s.data);var c,h,l={};try{for(var f=b(Object.keys(i)),d=f.next();!d.done;d=f.next()){var p=d.value,y=i[p];A(y)?l[p]=y(o,s.data):l[p]=y}}catch(i){c={error:i}}finally{try{d&&!d.done&&(h=f.return)&&h.call(f)}finally{if(c)throw c.error}}return l}function ue(i){return!!(i instanceof Promise||null!==i&&(A(i)||"object"==typeof i)&&A(i.then))}function fe(i,o,s,c){return i&&s.reduce(function(i,s){var h,l,f=s.assignment,d={state:c,action:s,_event:o},p={};if(A(f))p=f(i,o.data,d);else try{for(var y=b(Object.keys(f)),g=y.next();!g.done;g=y.next()){var m=g.value,x=f[m];p[m]=A(x)?x(i,o.data,d):x}}catch(i){h={error:i}}finally{try{g&&!g.done&&(l=y.return)&&l.call(y)}finally{if(h)throw h.error}}return Object.assign({},i,p)},i)}var k=function(){};function H(i){return Array.isArray(i)}function A(i){return"function"==typeof i}function T(i){return"string"==typeof i}function Bt(i,o){if(i)return T(i)?{type:D,name:i,predicate:o?o[i]:void 0}:A(i)?{type:D,name:i.name,predicate:i}:i}var V="function"==typeof Symbol&&Symbol.observable||"@@observable";function Q(i){return!!i&&"__xstatenode"in i}function vt(i,o){return T(i)||"number"==typeof i?v({type:i},o):i}function $(i,o){if(!T(i)&&"$$type"in i&&"scxml"===i.$$type)return i;var s=vt(i);return v({name:s.type,data:s,$$type:"scxml",type:"external"},o)}function at(i,o){return(H(o)?o:[o]).map(function(o){return typeof o>"u"||"string"==typeof o||Q(o)?{target:o,event:i}:v(v({},o),{event:i})})}function Qt(i,o,s,c,h){var l=i.options.guards,f={state:h,cond:o,_event:c};if(o.type===D)return((null==l?void 0:l[o.name])||o.predicate)(s,c.data,f);var d=null==l?void 0:l[o.type];if(!d)throw Error("Guard '".concat(o.type,"' is not implemented on machine '").concat(i.id,"'."));return d(s,c.data,f)}function Wt(i){return"string"==typeof i?{type:i}:i}function pt(i,o,s){var n=function(){},c="object"==typeof i,h=c?i:null;return{next:((c?i.next:i)||n).bind(h),error:((c?i.error:o)||n).bind(h),complete:((c?i.complete:s)||n).bind(h)}}function Dt(i,o){return"".concat(i,":invocation[").concat(o,"]")}function Mt(i){return(i.type===p||i.type===y&&i.to===G.Internal)&&"number"!=typeof i.delay}(tt={})[V]=function(){return this},tt[Symbol.observable]=function(){return this};var R=$({type:w});function Kt(i,o){return o&&o[i]||void 0}function mt(i,o){var s;if(T(i)||"number"==typeof i){var c=Kt(i,o);s=A(c)?{type:i,exec:c}:c||{type:i,exec:void 0}}else if(A(i))s={type:i.name||i.toString(),exec:i};else{var c=Kt(i.type,o);if(A(c))s=v(v({},i),{exec:c});else if(c){var h=c.type||i.type;s=v(v(v({},c),i),{type:h})}else s=i}return s}var W=function(i,o){return i?(H(i)?i:[i]).map(function(i){return mt(i,o)}):[]};function Ht(i){var o=mt(i);return v(v({id:T(i)?i:o.id},o),{type:o.type})}function Rt(i,o){var s="".concat(Z.DoneState,".").concat(i),c={type:s,data:o};return c.toString=function(){return s},c}function gt(i,o){var s="".concat(Z.DoneInvoke,".").concat(i),c={type:s,data:o};return c.toString=function(){return s},c}function st(i,o){var s="".concat(Z.ErrorPlatform,".").concat(i),c={type:s,data:o};return c.toString=function(){return s},c}var mr=function(i){var o,s,c=[];try{for(var h=b(i),l=h.next();!l.done;l=h.next())for(var f=l.value,d=0;d<f.actions.length;){if(f.actions[d].type===x){c.push(f.actions[d]),f.actions.splice(d,1);continue}d++}}catch(i){o={error:i}}finally{try{l&&!l.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}return c};function yt(i,o,s,c,h,l,f){void 0===f&&(f=!1);var g=f?[]:mr(h),m=g.length?fe(s,c,g,o):s,w=f?[s]:void 0,E=[];return[M(h.map(function(h){var g,O,N=[];try{for(var j=b(h.actions),C=j.next();!C.done;C=j.next()){var D=C.value,V=function(h,g){var O;switch(g.type){case p:var N=function(i,o,s,c){var h,l={_event:s},f=$(A(i.event)?i.event(o,s.data,l):i.event);if(T(i.delay)){var d=c&&c[i.delay];h=A(d)?d(o,s.data,l):d}else h=A(i.delay)?i.delay(o,s.data,l):i.delay;return v(v({},i),{type:p,_event:f,delay:h})}(g,m,c,i.options.delays);return l&&"number"==typeof N.delay&&l(N,m,c),N;case y:var j=function(i,o,s,c){var h,l={_event:s},f=$(A(i.event)?i.event(o,s.data,l):i.event);if(T(i.delay)){var d=c&&c[i.delay];h=A(d)?d(o,s.data,l):d}else h=A(i.delay)?i.delay(o,s.data,l):i.delay;var p=A(i.to)?i.to(o,s.data,l):i.to;return v(v({},i),{to:p,_event:f,event:f.data,delay:h})}(g,m,c,i.options.delays);return l&&j.to!==G.Internal&&("entry"===h?E.push(j):l(j,m,c)),j;case S:var C,D=(C=m,v(v({},g),{value:T(g.expr)?g.expr:g.expr(C,c.data,{_event:c})}));return null==l||l(D,m,c),D;case P:var V=null===(O=g.conds.find(function(s){var h=Bt(s.cond,i.options.guards);return!h||Qt(i,h,m,c,l?void 0:o)}))||void 0===O?void 0:O.actions;if(!V)return[];var R=_(yt(i,o,m,c,[{type:h,actions:W(z(V),i.options.actions)}],l,f),2),U=R[0];return m=R[1],null==w||w.push(m),U;case I:var V=g.get(m,c.data);if(!V)return[];var q=_(yt(i,o,m,c,[{type:h,actions:W(z(V),i.options.actions)}],l,f),2),B=q[0];return m=q[1],null==w||w.push(m),B;case d:var J,F,D=(J=m,F=A(g.activity)?g.activity(J,c.data):g.activity,{type:Z.Stop,activity:"string"==typeof F?{id:F}:F});return null==l||l(D,s,c),D;case x:m=fe(m,c,[g],l?void 0:o),null==w||w.push(m);break;default:var Y=mt(g,i.options.actions),K=Y.exec;if(l)l(Y,m,c);else if(K&&w){var X=w.length-1;Y=v(v({},Y),{exec:function(i){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];K.apply(void 0,L([w[X]],_(o),!1))}})}return Y}}(h.type,D);V&&(N=N.concat(V))}}catch(i){g={error:i}}finally{try{C&&!C.done&&(O=j.return)&&O.call(j)}finally{if(g)throw g.error}}return E.forEach(function(i){l(i,m,c)}),E.length=0,N})),m]}var rt=function(i,o){return o(i)};function Ye(i){var o;return(o={id:i,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:i}}})[V]=function(){return this},o}function ce(i,o,s){var c=Ye(o);if(c.deferred=!0,Q(i)){var h=c.state=rt(void 0,function(){return(s?i.withContext(s):i).initialState});c.getSnapshot=function(){return h}}return c}var Ct=function(i){return"atomic"===i.type||"final"===i.type};function de(i){return Object.keys(i.states).map(function(o){return i.states[o]})}function St(i){return de(i).filter(function(i){return"history"!==i.type})}function wt(i,o){var s,c,h,l,f,d,p,y,g=le(new Set(i)),m=new Set(o);try{for(var x=b(m),S=x.next();!S.done;S=x.next())for(var w=S.value,E=w.parent;E&&!m.has(E);)m.add(E),E=E.parent}catch(i){s={error:i}}finally{try{S&&!S.done&&(c=x.return)&&c.call(x)}finally{if(s)throw s.error}}var O=le(m);try{for(var N=b(m),j=N.next();!j.done;j=N.next()){var w=j.value;if("compound"!==w.type||O.get(w)&&O.get(w).length){if("parallel"===w.type)try{for(var P=(f=void 0,b(St(w))),I=P.next();!I.done;I=P.next()){var C=I.value;m.has(C)||(m.add(C),g.get(C)?g.get(C).forEach(function(i){return m.add(i)}):C.initialStateNodes.forEach(function(i){return m.add(i)}))}}catch(i){f={error:i}}finally{try{I&&!I.done&&(d=P.return)&&d.call(P)}finally{if(f)throw f.error}}}else g.get(w)?g.get(w).forEach(function(i){return m.add(i)}):w.initialStateNodes.forEach(function(i){return m.add(i)})}}catch(i){h={error:i}}finally{try{j&&!j.done&&(l=N.return)&&l.call(N)}finally{if(h)throw h.error}}try{for(var D=b(m),V=D.next();!V.done;V=D.next())for(var w=V.value,E=w.parent;E&&!m.has(E);)m.add(E),E=E.parent}catch(i){p={error:i}}finally{try{V&&!V.done&&(y=D.return)&&y.call(D)}finally{if(p)throw p.error}}return m}function le(i){var o,s,c=new Map;try{for(var h=b(i),l=h.next();!l.done;l=h.next()){var f=l.value;c.has(f)||c.set(f,[]),f.parent&&(c.has(f.parent)||c.set(f.parent,[]),c.get(f.parent).push(f))}}catch(i){o={error:i}}finally{try{l&&!l.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}return c}function xt(i,o){return Array.isArray(i)?i.some(function(i){return i===o}):i instanceof Set&&i.has(o)}function kt(i,o){return"compound"===o.type?St(o).some(function(o){return"final"===o.type&&xt(i,o)}):"parallel"===o.type&&St(o).every(function(o){return kt(i,o)})}function ve(i){return new Set(M(i.map(function(i){return i.tags})))}var U=function(){function e(i){var o,s,c=this;this.actions=[],this.activities=C,this.meta={},this.events=[],this.value=i.value,this.context=i.context,this._event=i._event,this._sessionid=i._sessionid,this.event=this._event.data,this.historyValue=i.historyValue,this.history=i.history,this.actions=i.actions||[],this.activities=i.activities||C,this.meta=(void 0===(o=i.configuration)&&(o=[]),o.reduce(function(i,o){return void 0!==o.meta&&(i[o.id]=o.meta),i},{})),this.events=i.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=i.configuration,this.transitions=i.transitions,this.children=i.children,this.done=!!i.done,this.tags=null!==(s=Array.isArray(i.tags)?new Set(i.tags):i.tags)&&void 0!==s?s:new Set,this.machine=i.machine,Object.defineProperty(this,"nextEvents",{get:function(){var i;return i=c.configuration,L([],_(new Set(M(L([],_(i.map(function(i){return i.ownEvents})),!1)))),!1)}})}return e.from=function(i,o){return i instanceof e?i.context!==o?new e({value:i.value,context:o,_event:i._event,_sessionid:null,historyValue:i.historyValue,history:i.history,actions:[],activities:i.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):i:new e({value:i,context:o,_event:R,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},e.create=function(i){return new e(i)},e.inert=function(i,o){return i instanceof e?i.actions.length?new e({value:i.value,context:o,_event:R,_sessionid:null,historyValue:i.historyValue,history:i.history,activities:i.activities,configuration:i.configuration,transitions:[],children:{}}):i:e.from(i,o)},e.prototype.toStrings=function(i,o){var s=this;if(void 0===i&&(i=this.value),void 0===o&&(o="."),T(i))return[i];var c=Object.keys(i);return c.concat.apply(c,L([],_(c.map(function(c){return s.toStrings(i[c],o).map(function(i){return c+o+i})})),!1))},e.prototype.toJSON=function(){this.configuration,this.transitions;var i=this.tags;this.machine;var o=ct(this,["configuration","transitions","tags","machine"]);return v(v({},o),{tags:Array.from(i)})},e.prototype.matches=function(i){return It(i,this.value)},e.prototype.hasTag=function(i){return this.tags.has(i)},e.prototype.can=function(i){k(!!this.machine);var o,s=null===(o=this.machine)||void 0===o?void 0:o.getTransitionData(this,i);return!!(null!=s&&s.transitions.length)&&s.transitions.some(function(i){return void 0!==i.target||i.actions.length})},e}(),q={deferEvents:!1},B=function(){function e(i){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=v(v({},q),i)}return e.prototype.initialize=function(i){if(this.initialized=!0,i){if(!this.options.deferEvents){this.schedule(i);return}this.process(i)}this.flushEvents()},e.prototype.schedule=function(i){if(!this.initialized||this.processingEvent){this.queue.push(i);return}if(0!==this.queue.length)throw Error("Event queue should be empty when it is not processing events");this.process(i),this.flushEvents()},e.prototype.clear=function(){this.queue=[]},e.prototype.flushEvents=function(){for(var i=this.queue.shift();i;)this.process(i),i=this.queue.shift()},e.prototype.process=function(i){this.processingEvent=!0;try{i()}catch(i){throw this.clear(),i}finally{this.processingEvent=!1}},e}(),J=new Map,F=0,Y={bookId:function(){return"x:".concat(F++)},register:function(i,o){return J.set(i,o),i},get:function(i){return J.get(i)},free:function(i){J.delete(i)}};function Zt(){return"u">typeof globalThis?globalThis:"u">typeof self?self:"u">typeof window?window:"u">typeof s.g?s.g:void 0}var K,X,Z,G,tt,tn,ti={sync:!1,autoForward:!1};(c=tn||(tn={}))[c.NotStarted=0]="NotStarted",c[c.Running=1]="Running",c[c.Stopped=2]="Stopped";var tr=function(){function e(i,o){void 0===o&&(o=e.defaultOptions);var s=this;this.machine=i,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=tn.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(i,o){if(H(i))return s.batch(i),s.state;var c=$(vt(i,o));if(s.status===tn.Stopped)return s.state;if(s.status!==tn.Running&&!s.options.deferEvents)throw Error('Event "'.concat(c.name,'" was sent to uninitialized service "').concat(s.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(c.data)));return s.scheduler.schedule(function(){s.forward(c);var i=s._nextState(c);s.update(i,c)}),s._state},this.sendTo=function(i,o,c){var h=s.parent&&(o===G.Parent||s.parent.id===o),l=h?s.parent:T(o)?o===G.Internal?s:s.children.get(o)||Y.get(o):o&&"function"==typeof o.send?o:void 0;if(!l){if(!h)throw Error("Unable to send event to child '".concat(o,"' from service '").concat(s.id,"'."));return}if("machine"in l){if(s.status!==tn.Stopped||s.parent!==l||s.state.done){var f=v(v({},i),{name:i.name===N?"".concat(st(s.id)):i.name,origin:s.sessionId});!c&&s.machine.config.predictableActionArguments?s._outgoingQueue.push([l,f]):l.send(f)}}else!c&&s.machine.config.predictableActionArguments?s._outgoingQueue.push([l,i.data]):l.send(i.data)},this._exec=function(i,o,c,h){void 0===h&&(h=s.machine.options.actions);var l=i.exec||Kt(i.type,h),m=A(l)?l:l?l.exec:i.exec;if(m)try{return m(o,c.data,s.machine.config.predictableActionArguments?{action:i,_event:c}:{action:i,state:s.state,_event:c})}catch(i){throw s.parent&&s.parent.send({type:"xstate.error",data:i}),i}switch(i.type){case p:s.defer(i);break;case y:if("number"==typeof i.delay){s.defer(i);return}i.to?s.sendTo(i._event,i.to,c===R):s.send(i._event);break;case g:s.cancel(i.sendId);break;case f:if(s.status!==tn.Running)return;var x=i.activity;if(!s.machine.config.predictableActionArguments&&!s.state.activities[x.id||x.type])break;if(x.type===Z.Invoke){var w=Wt(x.src),E=s.machine.options.services?s.machine.options.services[w.type]:void 0,O=x.id,N=x.data,j="autoForward"in x?x.autoForward:!!x.forward;if(!E)return;var P=N?ot(N,o,c):void 0;if("string"==typeof E)return;var I=A(E)?E(o,c.data,{data:P,src:w,meta:x.meta}):E;if(!I)return;var C=void 0;Q(I)&&(I=P?I.withContext(P):I,C={autoForward:j}),s.spawn(I,O,C)}else s.spawnActivity(x);break;case d:s.stopChild(i.activity.id);break;case S:var D=i.label,V=i.value;D?s.logger(D,V):s.logger(V)}};var c=v(v({},e.defaultOptions),o),h=c.clock,l=c.logger,m=c.parent,x=c.id,w=void 0!==x?x:i.id;this.id=w,this.logger=l,this.clock=h,this.parent=m,this.options=c,this.scheduler=new B({deferEvents:this.options.deferEvents}),this.sessionId=Y.bookId()}return Object.defineProperty(e.prototype,"initialState",{get:function(){var i=this;return this._initialState?this._initialState:rt(this,function(){return i._initialState=i.machine.initialState,i._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.execute=function(i,o){var s,c;try{for(var h=b(i.actions),l=h.next();!l.done;l=h.next()){var f=l.value;this.exec(f,i,o)}}catch(i){s={error:i}}finally{try{l&&!l.done&&(c=h.return)&&c.call(h)}finally{if(s)throw s.error}}},e.prototype.update=function(i,o){var s,c,h,l,f,d,p,y,g=this;if(i._sessionid=this.sessionId,this._state=i,(!this.machine.config.predictableActionArguments||o===R)&&this.options.execute)this.execute(this.state);else for(var m=void 0;m=this._outgoingQueue.shift();)m[0].send(m[1]);if(this.children.forEach(function(i){g.state.children[i.id]=i}),this.devTools&&this.devTools.send(o.data,i),i.event)try{for(var x=b(this.eventListeners),S=x.next();!S.done;S=x.next()){var w=S.value;w(i.event)}}catch(i){s={error:i}}finally{try{S&&!S.done&&(c=x.return)&&c.call(x)}finally{if(s)throw s.error}}try{for(var E=b(this.listeners),O=E.next();!O.done;O=E.next()){var w=O.value;w(i,i.event)}}catch(i){h={error:i}}finally{try{O&&!O.done&&(l=E.return)&&l.call(E)}finally{if(h)throw h.error}}try{for(var N=b(this.contextListeners),j=N.next();!j.done;j=N.next())(0,j.value)(this.state.context,this.state.history?this.state.history.context:void 0)}catch(i){f={error:i}}finally{try{j&&!j.done&&(d=N.return)&&d.call(N)}finally{if(f)throw f.error}}if(this.state.done){var P=i.configuration.find(function(i){return"final"===i.type&&i.parent===g.machine}),I=P&&P.doneData?ot(P.doneData,i.context,o):void 0;this._doneEvent=gt(this.id,I);try{for(var C=b(this.doneListeners),D=C.next();!D.done;D=C.next()){var w=D.value;w(this._doneEvent)}}catch(i){p={error:i}}finally{try{D&&!D.done&&(y=C.return)&&y.call(C)}finally{if(p)throw p.error}}this._stop(),this._stopChildren(),Y.free(this.sessionId)}},e.prototype.onTransition=function(i){return this.listeners.add(i),this.status===tn.Running&&i(this.state,this.state.event),this},e.prototype.subscribe=function(i,o,s){var c=this,h=pt(i,o,s);this.listeners.add(h.next),this.status!==tn.NotStarted&&h.next(this.state);var a=function(){c.doneListeners.delete(a),c.stopListeners.delete(a),h.complete()};return this.status===tn.Stopped?h.complete():(this.onDone(a),this.onStop(a)),{unsubscribe:function(){c.listeners.delete(h.next),c.doneListeners.delete(a),c.stopListeners.delete(a)}}},e.prototype.onEvent=function(i){return this.eventListeners.add(i),this},e.prototype.onSend=function(i){return this.sendListeners.add(i),this},e.prototype.onChange=function(i){return this.contextListeners.add(i),this},e.prototype.onStop=function(i){return this.stopListeners.add(i),this},e.prototype.onDone=function(i){return this.status===tn.Stopped&&this._doneEvent?i(this._doneEvent):this.doneListeners.add(i),this},e.prototype.off=function(i){return this.listeners.delete(i),this.eventListeners.delete(i),this.sendListeners.delete(i),this.stopListeners.delete(i),this.doneListeners.delete(i),this.contextListeners.delete(i),this},e.prototype.start=function(i){var o=this;if(this.status===tn.Running)return this;this.machine._init(),Y.register(this.sessionId,this),this.initialized=!0,this.status=tn.Running;var s=void 0===i?this.initialState:rt(this,function(){return"object"==typeof i&&null!==i&&"value"in i&&"_event"in i?o.machine.resolveState(i):o.machine.resolveState(U.from(i,o.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){o.update(s,R)}),this},e.prototype._stopChildren=function(){this.children.forEach(function(i){A(i.stop)&&i.stop()}),this.children.clear()},e.prototype._stop=function(){var i,o,s,c,h,l,f,d,p,y;try{for(var g=b(this.listeners),m=g.next();!m.done;m=g.next()){var x=m.value;this.listeners.delete(x)}}catch(o){i={error:o}}finally{try{m&&!m.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}try{for(var S=b(this.stopListeners),w=S.next();!w.done;w=S.next()){var x=w.value;x(),this.stopListeners.delete(x)}}catch(i){s={error:i}}finally{try{w&&!w.done&&(c=S.return)&&c.call(S)}finally{if(s)throw s.error}}try{for(var E=b(this.contextListeners),O=E.next();!O.done;O=E.next()){var x=O.value;this.contextListeners.delete(x)}}catch(i){h={error:i}}finally{try{O&&!O.done&&(l=E.return)&&l.call(E)}finally{if(h)throw h.error}}try{for(var N=b(this.doneListeners),j=N.next();!j.done;j=N.next()){var x=j.value;this.doneListeners.delete(x)}}catch(i){f={error:i}}finally{try{j&&!j.done&&(d=N.return)&&d.call(N)}finally{if(f)throw f.error}}if(!this.initialized)return this;this.initialized=!1,this.status=tn.Stopped,this._initialState=void 0;try{for(var P=b(Object.keys(this.delayedEventsMap)),I=P.next();!I.done;I=P.next()){var C=I.value;this.clock.clearTimeout(this.delayedEventsMap[C])}}catch(i){p={error:i}}finally{try{I&&!I.done&&(y=P.return)&&y.call(P)}finally{if(p)throw p.error}}this.scheduler.clear(),this.scheduler=new B({deferEvents:this.options.deferEvents})},e.prototype.stop=function(){var i=this,o=this.scheduler;return this._stop(),o.schedule(function(){var o=$({type:"xstate.stop"}),s=rt(i,function(){var s=M(L([],_(i.state.configuration),!1).sort(function(i,o){return o.order-i.order}).map(function(o){return W(o.onExit,i.machine.options.actions)})),c=_(yt(i.machine,i.state,i.state.context,o,[{type:"exit",actions:s}],i.machine.config.predictableActionArguments?i._exec:void 0,i.machine.config.predictableActionArguments||i.machine.config.preserveActionOrder),2),h=c[0],l=c[1],f=new U({value:i.state.value,context:l,_event:o,_sessionid:i.sessionId,historyValue:void 0,history:i.state,actions:h.filter(function(i){return!Mt(i)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:i.state.done,tags:i.state.tags,machine:i.machine});return f.changed=!0,f});i.update(s,o),i._stopChildren(),Y.free(i.sessionId)}),this},e.prototype.batch=function(i){var o=this;if(this.status===tn.NotStarted&&this.options.deferEvents);else if(this.status!==tn.Running)throw Error("".concat(i.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(i.length){var s=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var c,h,l=o.state,f=!1,d=[];try{for(var p=b(i),y=p.next();!y.done;y=p.next()){var g=y.value;(function(i){var c=$(i);o.forward(c),l=rt(o,function(){return o.machine.transition(l,c,void 0,s||void 0)}),d.push.apply(d,L([],_(o.machine.config.predictableActionArguments?l.actions:l.actions.map(function(i){var o,s;return o=l,s=i.exec,v(v({},i),{exec:void 0!==s?function(){return s(o.context,o.event,{action:i,state:o,_event:o._event})}:void 0})})),!1)),f=f||!!l.changed})(g)}}catch(i){c={error:i}}finally{try{y&&!y.done&&(h=p.return)&&h.call(p)}finally{if(c)throw c.error}}l.changed=f,l.actions=d,o.update(l,$(i[i.length-1]))})}},e.prototype.sender=function(i){return this.send.bind(this,i)},e.prototype._nextState=function(i,o){var s=this;void 0===o&&(o=!!this.machine.config.predictableActionArguments&&this._exec);var c=$(i);if(0===c.name.indexOf(O)&&!this.state.nextEvents.some(function(i){return 0===i.indexOf(O)}))throw c.data.data;return rt(this,function(){return s.machine.transition(s.state,c,void 0,o||void 0)})},e.prototype.nextState=function(i){return this._nextState(i,!1)},e.prototype.forward=function(i){var o,s;try{for(var c=b(this.forwardTo),h=c.next();!h.done;h=c.next()){var l=h.value,f=this.children.get(l);if(!f)throw Error("Unable to forward event '".concat(i,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(l,"'."));f.send(i)}}catch(i){o={error:i}}finally{try{h&&!h.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}},e.prototype.defer=function(i){var o=this,s=this.clock.setTimeout(function(){"to"in i&&i.to?o.sendTo(i._event,i.to,!0):o.send(i._event)},i.delay);i.id&&(this.delayedEventsMap[i.id]=s)},e.prototype.cancel=function(i){this.clock.clearTimeout(this.delayedEventsMap[i]),delete this.delayedEventsMap[i]},e.prototype.exec=function(i,o,s){void 0===s&&(s=this.machine.options.actions),this._exec(i,o.context,o._event,s)},e.prototype.removeChild=function(i){var o;this.children.delete(i),this.forwardTo.delete(i),null===(o=this.state)||void 0===o||delete o.children[i]},e.prototype.stopChild=function(i){var o=this.children.get(i);o&&(this.removeChild(i),A(o.stop)&&o.stop())},e.prototype.spawn=function(i,o,s){if(this.status!==tn.Running)return ce(i,o);if(ue(i))return this.spawnPromise(Promise.resolve(i),o);if(A(i))return this.spawnCallback(i,o);if(function(i){try{return"function"==typeof i.send}catch{return!1}}(i)&&"id"in i)return this.spawnActor(i,o);if(function(i){try{return"subscribe"in i&&A(i.subscribe)}catch{return!1}}(i))return this.spawnObservable(i,o);if(Q(i))return this.spawnMachine(i,v(v({},s),{id:o}));if(null!==i&&"object"==typeof i&&"transition"in i&&"function"==typeof i.transition)return this.spawnBehavior(i,o);throw Error('Unable to spawn entity "'.concat(o,'" of type "').concat(typeof i,'".'))},e.prototype.spawnMachine=function(i,o){var s=this;void 0===o&&(o={});var c=new e(i,v(v({},this.options),{parent:this,id:o.id||i.id})),h=v(v({},ti),o);return h.sync&&c.onTransition(function(i){s.send(j,{state:i,id:c.id})}),this.children.set(c.id,c),h.autoForward&&this.forwardTo.add(c.id),c.onDone(function(i){s.removeChild(c.id),s.send($(i,{origin:c.id}))}).start(),c},e.prototype.spawnBehavior=function(i,o){var s,c,h,l,f,d,p,y,g,m,x=(s={id:o,parent:this},l=i.initialState,f=new Set,d=[],p=!1,y=function(){if(!p){for(p=!0;d.length>0;){var o=d.shift();l=i.transition(l,o,m),f.forEach(function(i){return i.next(l)})}p=!1}},c={id:s.id,send:function(i){d.push(i),y()},getSnapshot:function(){return l},subscribe:function(i,o,s){var c=pt(i,o,s);return f.add(c),c.next(l),{unsubscribe:function(){f.delete(c)}}}},g=v(((h={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}})[V]=function(){return this},h),c),m={parent:s.parent,self:g,id:s.id||"anonymous",observers:f},l=i.start?i.start(m):l,g);return this.children.set(o,x),x},e.prototype.spawnPromise=function(i,o){var s,c,h=this,l=!1;i.then(function(i){l||(c=i,h.removeChild(o),h.send($(gt(o,i),{origin:o})))},function(i){if(!l){h.removeChild(o);var s=st(o,i);try{h.send($(s,{origin:o}))}catch(i){h.devTools&&h.devTools.send(s,h.state),h.machine.strict&&h.stop()}}});var f=((s={id:o,send:function(){},subscribe:function(o,s,c){var h=pt(o,s,c),l=!1;return i.then(function(i){l||(h.next(i),l||h.complete())},function(i){l||h.error(i)}),{unsubscribe:function(){return l=!0}}},stop:function(){l=!0},toJSON:function(){return{id:o}},getSnapshot:function(){return c}})[V]=function(){return this},s);return this.children.set(o,f),f},e.prototype.spawnCallback=function(i,o){var s,c,h,l=this,f=!1,d=new Set,p=new Set;try{h=i(function(i){c=i,p.forEach(function(o){return o(i)}),f||l.send($(i,{origin:o}))},function(i){d.add(i)})}catch(i){this.send(st(o,i))}if(ue(h))return this.spawnPromise(h,o);var y=((s={id:o,send:function(i){return d.forEach(function(o){return o(i)})},subscribe:function(i){var o=pt(i);return p.add(o.next),{unsubscribe:function(){p.delete(o.next)}}},stop:function(){f=!0,A(h)&&h()},toJSON:function(){return{id:o}},getSnapshot:function(){return c}})[V]=function(){return this},s);return this.children.set(o,y),y},e.prototype.spawnObservable=function(i,o){var s,c,h=this,l=i.subscribe(function(i){c=i,h.send($(i,{origin:o}))},function(i){h.removeChild(o),h.send($(st(o,i),{origin:o}))},function(){h.removeChild(o),h.send($(gt(o),{origin:o}))}),f=((s={id:o,send:function(){},subscribe:function(o,s,c){return i.subscribe(o,s,c)},stop:function(){return l.unsubscribe()},getSnapshot:function(){return c},toJSON:function(){return{id:o}}})[V]=function(){return this},s);return this.children.set(o,f),f},e.prototype.spawnActor=function(i,o){return this.children.set(o,i),i},e.prototype.spawnActivity=function(i){var o=this.machine.options&&this.machine.options.activities?this.machine.options.activities[i.type]:void 0;if(o){var s=o(this.state.context,i);this.spawnEffect(i.id,s)}},e.prototype.spawnEffect=function(i,o){var s;this.children.set(i,((s={id:i,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:o||void 0,getSnapshot:function(){},toJSON:function(){return{id:i}}})[V]=function(){return this},s))},e.prototype.attachDev=function(){var i=Zt();if(this.options.devTools&&i){if(i.__REDUX_DEVTOOLS_EXTENSION__){var o="object"==typeof this.options.devTools?this.options.devTools:void 0;this.devTools=i.__REDUX_DEVTOOLS_EXTENSION__.connect(v(v({name:this.id,autoPause:!0,stateSanitizer:function(i){return{value:i.value,context:i.context,actions:i.actions}}},o),{features:v({jump:!1,skip:!1},o?o.features:void 0)}),this.machine),this.devTools.init(this.state)}(function(i){if(Zt()){var o=function(){var i=Zt();if(i&&"__xstate__"in i)return i.__xstate__}();o&&o.register(i)}})(this)}},e.prototype.toJSON=function(){return{id:this.id}},e.prototype[V]=function(){return this},e.prototype.getSnapshot=function(){return this.status===tn.NotStarted?this.initialState:this._state},e.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(i,o){return setTimeout(i,o)},clearTimeout:function(i){return clearTimeout(i)}},logger:console.log.bind(console),devTools:!1},e.interpret=te,e}();function te(i,o){return new tr(i,o)}function Ut(i){return v(v({type:E},i),{toJSON:function(){i.onDone,i.onError;var o=ct(i,["onDone","onError"]);return v(v({},o),{type:E,src:function(i){if("string"==typeof i){var o={type:i};return o.toString=function(){return i},o}return i}(i.src)})}})}var to={},_t=function(i){return"#"===i[0]},ta=function(){function e(i,o,s,c){void 0===s&&(s="context"in i?i.context:void 0);var h,l=this;this.config=i,this._context=s,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},o),this.parent=null==c?void 0:c.parent,this.key=this.config.key||(null==c?void 0:c.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||L([this.machine.key],_(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(h=this.config.schema)&&void 0!==h?h:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?ht(this.config.states,function(i,o){var s,c=new e(i,{},void 0,{parent:l,key:o});return Object.assign(l.idMap,v(((s={})[c.id]=c,s),c.idMap)),c}):to;var f=0;(function u(i){var o,s;i.order=f++;try{for(var c=b(de(i)),h=c.next();!h.done;h=c.next()){var l=h.value;u(l)}}catch(i){o={error:i}}finally{try{h&&!h.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}})(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some(function(i){return""===i.event}):""in this.config.on),this.strict=!!this.config.strict,this.onEntry=z(this.config.entry||this.config.onEntry).map(function(i){return mt(i)}),this.onExit=z(this.config.exit||this.config.onExit).map(function(i){return mt(i)}),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=z(this.config.invoke).map(function(i,o){if(Q(i)){var s,c,h=Dt(l.id,o);return l.machine.options.services=v(((s={})[h]=i,s),l.machine.options.services),Ut({src:h,id:h})}if(T(i.src)){var h=i.id||Dt(l.id,o);return Ut(v(v({},i),{id:h,src:i.src}))}if(Q(i.src)||A(i.src)){var h=i.id||Dt(l.id,o);return l.machine.options.services=v(((c={})[h]=i.src,c),l.machine.options.services),Ut(v(v({id:h},i),{src:h}))}var f=i.src;return Ut(v(v({id:Dt(l.id,o)},i),{src:f}))}),this.activities=z(this.config.activities).concat(this.invoke).map(function(i){return Ht(i)}),this.transition=this.transition.bind(this),this.tags=z(this.config.tags)}return e.prototype._init=function(){this.__cache.transitions||(function he(i){var o=[i];return Ct(i)?o:o.concat(M(St(i).map(he)))})(this).forEach(function(i){return i.on})},e.prototype.withConfig=function(i,o){var s=this.options,c=s.actions,h=s.activities,l=s.guards,f=s.services,d=s.delays;return new e(this.config,{actions:v(v({},c),i.actions),activities:v(v({},h),i.activities),guards:v(v({},l),i.guards),services:v(v({},f),i.services),delays:v(v({},d),i.delays)},null!=o?o:this.context)},e.prototype.withContext=function(i){return new e(this.config,this.options,i)},Object.defineProperty(e.prototype,"context",{get:function(){return A(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:ht(this.states,function(i){return i.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return this.definition},Object.defineProperty(e.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var i=this.transitions;return this.__cache.on=i.reduce(function(i,o){return i[o.eventType]=i[o.eventType]||[],i[o.eventType].push(o),i},{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),e.prototype.getCandidates=function(i){if(this.__cache.candidates[i])return this.__cache.candidates[i];var o=""===i,s=this.transitions.filter(function(s){var c=s.eventType===i;return o?c:c||"*"===s.eventType});return this.__cache.candidates[i]=s,s},e.prototype.getDelayedTransitions=function(){var i=this,o=this.config.after;if(!o)return[];var n=function(o,s){var c,h,l,f,d=(c=A(o)?"".concat(i.id,":delay[").concat(s,"]"):o,l=(h=i.id)?"#".concat(h):"","".concat(Z.After,"(").concat(c,")").concat(l));return i.onEntry.push({to:(f={delay:o}).to,type:y,event:A(d)?d:vt(d),delay:f?f.delay:void 0,id:f&&void 0!==f.id?f.id:A(d)?d.name:qt(d)}),i.onExit.push({type:g,sendId:d}),d};return(H(o)?o.map(function(i,o){var s=n(i.delay,o);return v(v({},i),{event:s})}):M(Object.keys(o).map(function(i,s){var c=o[i],h=T(c)?{target:c}:c,l=isNaN(+i)?i:+i,f=n(l,s);return z(h).map(function(i){return v(v({},i),{event:f,delay:l})})}))).map(function(o){var s=o.delay;return v(v({},i.formatTransition(o)),{delay:s})})},e.prototype.getStateNodes=function(i){var o,s=this;if(!i)return[];var c=i instanceof U?i.value:dt(i,this.delimiter);if(T(c)){var h=this.getStateNode(c).initial;return void 0!==h?this.getStateNodes(((o={})[c]=h,o)):[this,this.states[c]]}var l=Object.keys(c),f=[this];return f.push.apply(f,L([],_(M(l.map(function(i){return s.getStateNode(i).getStateNodes(c[i])}))),!1)),f},e.prototype.handles=function(i){var o=qt(i);return this.events.includes(o)},e.prototype.resolveState=function(i){var o=i instanceof U?i:U.create(i),s=Array.from(wt([],this.getStateNodes(o.value)));return new U(v(v({},o),{value:this.resolve(o.value),configuration:s,done:kt(s,this),tags:ve(s),machine:this.machine}))},e.prototype.transitionLeafNode=function(i,o,s){var c=this.getStateNode(i).next(o,s);return c&&c.transitions.length?c:this.next(o,s)},e.prototype.transitionCompoundNode=function(i,o,s){var c=Object.keys(i),h=this.getStateNode(c[0])._transition(i[c[0]],o,s);return h&&h.transitions.length?h:this.next(o,s)},e.prototype.transitionParallelNode=function(i,o,s){var c,h,l={};try{for(var f=b(Object.keys(i)),d=f.next();!d.done;d=f.next()){var p=d.value,y=i[p];if(y){var g=this.getStateNode(p)._transition(y,o,s);g&&(l[p]=g)}}}catch(i){c={error:i}}finally{try{d&&!d.done&&(h=f.return)&&h.call(f)}finally{if(c)throw c.error}}var m=Object.keys(l).map(function(i){return l[i]}),x=M(m.map(function(i){return i.transitions}));if(!m.some(function(i){return i.transitions.length>0}))return this.next(o,s);var S=M(Object.keys(l).map(function(i){return l[i].configuration}));return{transitions:x,exitSet:M(m.map(function(i){return i.exitSet})),configuration:S,source:o,actions:M(Object.keys(l).map(function(i){return l[i].actions}))}},e.prototype._transition=function(i,o,s){return T(i)?this.transitionLeafNode(i,o,s):1===Object.keys(i).length?this.transitionCompoundNode(i,o,s):this.transitionParallelNode(i,o,s)},e.prototype.getTransitionData=function(i,o){return this._transition(i.value,i,$(o))},e.prototype.next=function(i,o){var s,c,h,l=this,f=o.name,d=[],p=[];try{for(var y=b(this.getCandidates(f)),g=y.next();!g.done;g=y.next()){var m=g.value,x=m.cond,S=m.in,w=i.context,E=!S||(T(S)&&_t(S)?i.matches(dt(this.getStateNodeById(S).path,this.delimiter)):It(dt(S,this.delimiter),Pe(this.path.slice(0,-2))(i.value))),O=!1;try{O=!x||Qt(this.machine,x,w,o,i)}catch(i){throw Error("Unable to evaluate guard '".concat(x.name||x.type,"' in transition for event '").concat(f,"' in state node '").concat(this.id,`':
`).concat(i.message))}if(O&&E){void 0!==m.target&&(p=m.target),d.push.apply(d,L([],_(m.actions),!1)),h=m;break}}}catch(i){s={error:i}}finally{try{g&&!g.done&&(c=y.return)&&c.call(y)}finally{if(s)throw s.error}}if(h){if(!p.length)return{transitions:[h],exitSet:[],configuration:i.value?[this]:[],source:i,actions:d};var N=M(p.map(function(o){return l.getRelativeStateNodes(o,i.historyValue)})),j=!!h.internal;return{transitions:[h],exitSet:j?[]:M(p.map(function(i){return l.getPotentiallyReenteringNodes(i)})),configuration:N,source:i,actions:d}}},e.prototype.getPotentiallyReenteringNodes=function(i){if(this.order<i.order)return[this];for(var o=[],s=this;s&&s!==i;)o.push(s),s=s.parent;return s!==i?[]:(o.push(i),o)},e.prototype.getActions=function(i,o,s,c,h,l,f){var d,y,g,m,x=this,S=l?wt([],this.getStateNodes(l.value)):[],w=new Set;try{for(var E=b(Array.from(i).sort(function(i,o){return i.order-o.order})),O=E.next();!O.done;O=E.next()){var N=O.value;(!xt(S,N)||xt(s.exitSet,N)||N.parent&&w.has(N.parent))&&w.add(N)}}catch(i){d={error:i}}finally{try{O&&!O.done&&(y=E.return)&&y.call(E)}finally{if(d)throw d.error}}try{for(var j=b(S),P=j.next();!P.done;P=j.next()){var N=P.value;(!xt(i,N)||xt(s.exitSet,N.parent))&&s.exitSet.push(N)}}catch(i){g={error:i}}finally{try{P&&!P.done&&(m=j.return)&&m.call(j)}finally{if(g)throw g.error}}s.exitSet.sort(function(i,o){return o.order-i.order});var I=Array.from(w).sort(function(i,o){return i.order-o.order}),C=new Set(s.exitSet),D=M(I.map(function(i){var o=[];if("final"!==i.type)return o;var l=i.parent;if(!l.parent)return o;o.push(Rt(i.id,i.doneData),Rt(l.id,i.doneData?ot(i.doneData,c,h):void 0));var f=l.parent;return"parallel"===f.type&&St(f).every(function(i){return kt(s.configuration,i)})&&o.push(Rt(f.id)),o})),V=I.map(function(i){var o=i.onEntry,s=i.activities.map(function(i){var o;return o=Ht(i),{type:Z.Start,activity:o,exec:void 0}});return{type:"entry",actions:W(f?L(L([],_(o),!1),_(s),!1):L(L([],_(s),!1),_(o),!1),x.machine.options.actions)}}).concat({type:"state_done",actions:D.map(function(i){var o;return{type:p,event:"function"==typeof i?i:vt(i),delay:o?o.delay:void 0,id:null==o?void 0:o.id}})}),R=Array.from(C).map(function(i){return{type:"exit",actions:W(L(L([],_(i.onExit),!1),_(i.activities.map(function(i){var o;return o=A(i)?i:Ht(i),{type:Z.Stop,activity:o,exec:void 0}})),!1),x.machine.options.actions)}}).concat({type:"transition",actions:W(s.actions,this.machine.options.actions)}).concat(V);if(o){var U=W(M(L([],_(i),!1).sort(function(i,o){return o.order-i.order}).map(function(i){return i.onExit})),this.machine.options.actions).filter(function(i){return!Mt(i)});return R.concat({type:"stop",actions:U})}return R},e.prototype.transition=function(i,o,s,c){void 0===i&&(i=this.initialState);var h,l,f=$(o);if(i instanceof U)l=void 0===s?i:this.resolveState(U.from(i,s));else{var d=T(i)?this.resolve(Nt(this.getResolvedPath(i))):this.resolve(i),p=null!=s?s:this.machine.context;l=this.resolveState(U.from(d,p))}if(this.strict&&!this.events.includes(f.name)&&(h=f.name,!/^(done|error)\./.test(h)))throw Error("Machine '".concat(this.id,"' does not accept event '").concat(f.name,"'"));var y=this._transition(l.value,l,f)||{transitions:[],configuration:[],exitSet:[],source:l,actions:[]},g=wt([],this.getStateNodes(l.value)),m=y.configuration.length?wt(g,y.configuration):g;return y.configuration=L([],_(m),!1),this.resolveTransition(y,l,l.context,c,f)},e.prototype.resolveRaisedTransition=function(i,o,s,c){var h,l=i.actions;return(i=this.transition(i,o,void 0,c))._event=s,i.event=s.data,(h=i.actions).unshift.apply(h,L([],_(l),!1)),i},e.prototype.resolveTransition=function(i,o,s,c,h){var l,p,y,g,x,S,w=this;void 0===h&&(h=R);var O=i.configuration,N=!o||i.transitions.length>0,P=N?i.configuration:o?o.configuration:[],I=kt(P,this),C=N?(p=wt([l=this.machine],O),function Ke(i,o){var s=o.get(i);if(!s)return{};if("compound"===i.type){var c=s[0];if(!c)return{};if(Ct(c))return c.key}var h={};return s.forEach(function(i){h[i.key]=Ke(i,o)}),h}(l,le(p))):void 0,D=o?o.historyValue?o.historyValue:i.source?this.machine.historyValue(o.value):void 0:void 0,V=this.getActions(new Set(P),I,i,s,h,o,c),q=o?v({},o.activities):{};try{for(var B=b(V),J=B.next();!J.done;J=B.next()){var F=J.value;try{for(var Y=(x=void 0,b(F.actions)),K=Y.next();!K.done;K=Y.next()){var X=K.value;X.type===f?q[X.activity.id||X.activity.type]=X:X.type===d&&(q[X.activity.id||X.activity.type]=!1)}}catch(i){x={error:i}}finally{try{K&&!K.done&&(S=Y.return)&&S.call(Y)}finally{if(x)throw x.error}}}}catch(i){y={error:i}}finally{try{J&&!J.done&&(g=B.return)&&g.call(B)}finally{if(y)throw y.error}}var Z=_(yt(this,o,s,h,V,c,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),G=Z[0],tt=Z[1],tn=_(function(i,o){var s,c,h=_([[],[]],2),l=h[0],f=h[1];try{for(var d=b(i),p=d.next();!p.done;p=d.next()){var y=p.value;o(y)?l.push(y):f.push(y)}}catch(i){s={error:i}}finally{try{p&&!p.done&&(c=d.return)&&c.call(d)}finally{if(s)throw s.error}}return[l,f]}(G,Mt),2),ti=tn[0],tr=tn[1],to=G.filter(function(i){var o;return i.type===f&&(null===(o=i.activity)||void 0===o?void 0:o.type)===E}).reduce(function(i,o){var s,c,l,f,d,p,y,g;return i[o.activity.id]=(s=o.activity,c=w.machine,l=h,d=Wt(s.src),p=null===(f=null==c?void 0:c.options.services)||void 0===f?void 0:f[d.type],y=s.data?ot(s.data,tt,l):void 0,(g=p?ce(p,s.id,y):Ye(s.id)).meta=s,g),i},o?v({},o.children):{}),ta=new U({value:C||o.value,context:tt,_event:h,_sessionid:o?o._sessionid:null,historyValue:C?D?{current:C,states:function Me(i,o){return ht(i.states,function(i,s){if(i){var c=(T(o)?void 0:o[s])||(i?i.current:void 0);if(c)return{current:c,states:Me(i,c)}}})}(D,C)}:void 0:o?o.historyValue:void 0,history:!C||i.source?o:void 0,actions:C?tr:[],activities:C?q:o?o.activities:{},events:[],configuration:P,transitions:i.transitions,children:to,done:I,tags:ve(P),machine:this}),ts=s!==tt;ta.changed=h.name===j||ts;var tc=ta.history;tc&&delete tc.history;var tu=!I&&(this._transient||O.some(function(i){return i._transient}));if(!N&&(!tu||""===h.name))return ta;var th=ta;if(!I)for(tu&&(th=this.resolveRaisedTransition(th,{type:m},h,c));ti.length;){var tl=ti.shift();th=this.resolveRaisedTransition(th,tl._event,h,c)}var tf=th.changed||(tc?!!th.actions.length||ts||typeof tc.value!=typeof th.value||!function pe(i,o){if(i===o)return!0;if(void 0===i||void 0===o)return!1;if(T(i)||T(o))return i===o;var s=Object.keys(i),c=Object.keys(o);return s.length===c.length&&s.every(function(s){return pe(i[s],o[s])})}(th.value,tc.value):void 0);return th.changed=tf,th.history=tc,th},e.prototype.getStateNode=function(i){if(_t(i))return this.machine.getStateNodeById(i);if(!this.states)throw Error("Unable to retrieve child state '".concat(i,"' from '").concat(this.id,"'; no child states exist."));var o=this.states[i];if(!o)throw Error("Child state '".concat(i,"' does not exist on '").concat(this.id,"'"));return o},e.prototype.getStateNodeById=function(i){var o=_t(i)?i.slice(1):i;if(o===this.id)return this;var s=this.machine.idMap[o];if(!s)throw Error("Child state node '#".concat(o,"' does not exist on machine '").concat(this.id,"'"));return s},e.prototype.getStateNodeByPath=function(i){if("string"==typeof i&&_t(i))try{return this.getStateNodeById(i.slice(1))}catch{}for(var o=Yt(i,this.delimiter).slice(),s=this;o.length;){var c=o.shift();if(!c.length)break;s=s.getStateNode(c)}return s},e.prototype.resolve=function(i){var o,s=this;if(!i)return this.initialStateValue||to;switch(this.type){case"parallel":return ht(this.initialStateValue,function(o,c){return o?s.getStateNode(c).resolve(i[c]||o):to});case"compound":if(T(i)){var c=this.getStateNode(i);return"parallel"===c.type||"compound"===c.type?((o={})[i]=c.initialStateValue,o):i}return Object.keys(i).length?ht(i,function(i,o){return i?s.getStateNode(o).resolve(i):to}):this.initialStateValue||{};default:return i||to}},e.prototype.getResolvedPath=function(i){if(_t(i)){var o=this.machine.idMap[i.slice(1)];if(!o)throw Error("Unable to find state node '".concat(i,"'"));return o.path}return Yt(i,this.delimiter)},Object.defineProperty(e.prototype,"initialStateValue",{get:function(){var i,o;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)o=se(this.states,function(i){return i.initialStateValue||to},function(i){return"history"!==i.type});else if(void 0!==this.initial){if(!this.states[this.initial])throw Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));o=Ct(this.states[this.initial])?this.initial:((i={})[this.initial]=this.states[this.initial].initialStateValue,i)}else o={};return this.__cache.initialStateValue=o,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),e.prototype.getInitialState=function(i,o){this._init();var s=this.getStateNodes(i);return this.resolveTransition({configuration:s,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!=o?o:this.machine.context,void 0)},Object.defineProperty(e.prototype,"initialState",{get:function(){var i=this.initialStateValue;if(!i)throw Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(i)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){var i;if("history"===this.type){var o=this.config;i=T(o.target)&&_t(o.target)?Nt(this.machine.getStateNodeById(o.target).path.slice(this.path.length-1)):o.target}return i},enumerable:!1,configurable:!0}),e.prototype.getRelativeStateNodes=function(i,o,s){return void 0===s&&(s=!0),s?"history"===i.type?i.resolveHistory(o):i.initialStateNodes:[i]},Object.defineProperty(e.prototype,"initialStateNodes",{get:function(){var i=this;return Ct(this)||"compound"===this.type&&!this.initial?[this]:M(jt(this.initialStateValue).map(function(o){return i.getFromRelativePath(o)}))},enumerable:!1,configurable:!0}),e.prototype.getFromRelativePath=function(i){if(!i.length)return[this];var o=_(i),s=o[0],c=o.slice(1);if(!this.states)throw Error("Cannot retrieve subPath '".concat(s,"' from node with no states"));var h=this.getStateNode(s);if("history"===h.type)return h.resolveHistory();if(!this.states[s])throw Error("Child state '".concat(s,"' does not exist on '").concat(this.id,"'"));return this.states[s].getFromRelativePath(c)},e.prototype.historyValue=function(i){if(Object.keys(this.states).length)return{current:i||this.initialStateValue,states:se(this.states,function(o,s){if(!i)return o.historyValue();var c=T(i)?void 0:i[s];return o.historyValue(c||o.initialStateValue)},function(i){return!i.history})}},e.prototype.resolveHistory=function(i){var o,s=this;if("history"!==this.type)return[this];var c=this.parent;if(!i){var h=this.target;return h?M(jt(h).map(function(i){return c.getFromRelativePath(i)})):c.initialStateNodes}var l=(o=c.path,function(i){var s,c,h=i;try{for(var l=b(o),f=l.next();!f.done;f=l.next()){var d=f.value;h=h.states[d]}}catch(i){s={error:i}}finally{try{f&&!f.done&&(c=l.return)&&c.call(l)}finally{if(s)throw s.error}}return h})(i).current;return T(l)?[c.getStateNode(l)]:M(jt(l).map(function(i){return"deep"===s.history?c.getFromRelativePath(i):[c.states[i[0]]]}))},Object.defineProperty(e.prototype,"stateIds",{get:function(){var i=this,o=M(Object.keys(this.states).map(function(o){return i.states[o].stateIds}));return[this.id].concat(o)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){if(this.__cache.events)return this.__cache.events;var i,o,s,c,h=this.states,l=new Set(this.ownEvents);if(h)try{for(var f=b(Object.keys(h)),d=f.next();!d.done;d=f.next()){var p=h[d.value];if(p.states)try{for(var y=(s=void 0,b(p.events)),g=y.next();!g.done;g=y.next()){var m=g.value;l.add("".concat(m))}}catch(i){s={error:i}}finally{try{g&&!g.done&&(c=y.return)&&c.call(y)}finally{if(s)throw s.error}}}}catch(o){i={error:o}}finally{try{d&&!d.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}return this.__cache.events=Array.from(l)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownEvents",{get:function(){return Array.from(new Set(this.transitions.filter(function(i){return!(!i.target&&!i.actions.length&&i.internal)}).map(function(i){return i.eventType})))},enumerable:!1,configurable:!0}),e.prototype.resolveTarget=function(i){var o=this;if(void 0!==i)return i.map(function(i){if(!T(i))return i;var s=i[0]===o.delimiter;if(s&&!o.parent)return o.getStateNodeByPath(i.slice(1));var c=s?o.key+i:i;if(!o.parent)return o.getStateNodeByPath(c);try{return o.parent.getStateNodeByPath(c)}catch(i){throw Error("Invalid transition definition for state node '".concat(o.id,`':
`).concat(i.message))}})},e.prototype.formatTransition=function(i){var o=this,s=function(i){if(!(void 0===i||""===i))return z(i)}(i.target),c="internal"in i?i.internal:!s||s.some(function(i){return T(i)&&i[0]===o.delimiter}),h=this.machine.options.guards,l=this.resolveTarget(s),f=v(v({},i),{actions:W(z(i.actions)),cond:Bt(i.cond,h),target:l,source:this,internal:c,eventType:i.event,toJSON:function(){return v(v({},f),{target:f.target?f.target.map(function(i){return"#".concat(i.id)}):void 0,source:"#".concat(o.id)})}});return f},e.prototype.formatTransitions=function(){var i,o,s,c=this;if(this.config.on){if(Array.isArray(this.config.on))s=this.config.on;else{var h=this.config.on,l=h["*"],f=void 0===l?[]:l,d=ct(h,["*"]);s=M(Object.keys(d).map(function(i){return at(i,d[i])}).concat(at("*",f)))}}else s=[];var p=this.config.always?at("",this.config.always):[],y=this.config.onDone?at(String(Rt(this.id)),this.config.onDone):[],g=M(this.invoke.map(function(i){var o=[];return i.onDone&&o.push.apply(o,L([],_(at(String(gt(i.id)),i.onDone)),!1)),i.onError&&o.push.apply(o,L([],_(at(String(st(i.id)),i.onError)),!1)),o})),m=this.after,x=M(L(L(L(L([],_(y),!1),_(g),!1),_(s),!1),_(p),!1).map(function(i){return z(i).map(function(i){return c.formatTransition(i)})}));try{for(var S=b(m),w=S.next();!w.done;w=S.next()){var E=w.value;x.push(E)}}catch(o){i={error:o}}finally{try{w&&!w.done&&(o=S.return)&&o.call(S)}finally{if(i)throw i.error}}return x},e}(),ts={click:"onClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",complete:"onComplete",after:"onAfter",enter:"onEnter",show:"onShow"};Object.values(ts);var tc=Object.keys(ts),tu=class{activeStateId="";_service;_domListeners=new Map;_domElement;_playerListeners=new Map;_player;_machineSchemas=new Map;_onShowPrevValue=0;constructor(i,o){this._player=o,this._machineSchemas=this._transformToXStateSchema(i),this._domElement=o.container}start(i){this.stop();let o=this._machineSchemas.get(i);if(typeof o>"u")throw(0,l.h)(`invalid state machine id ${i}`);this._service=te(new ta(o,void 0)),this._addEventListeners(),this._service.start()}stop(){var i;this._removeEventListeners(),null==(i=this._service)||i.stop(),this._player.stop()}_removeEventListeners(){var i;for(let[o,s]of(this._requiresDomElement(),this._domListeners))"visibilityChange"===o&&this._player.stopPlayOnShow(),null==(i=this._domElement)||i.removeEventListener(o,s),this._domListeners.delete(o);for(let[i,o]of this._playerListeners)this._player.removeEventListener(i,o),this._playerListeners.delete(i)}_addEventListeners(){this._requiresDomElement();let t=i=>{this._service.send({type:i})},r=i=>function(){t(i)};this._service.subscribe(i=>{var o;if(typeof i.changed>"u"||i.changed){for(let s of(this._removeEventListeners(),i.nextEvents))if(tc.filter(i=>"complete"!==i&&"show"!==i).includes(s)){let i=r(s);this._domListeners.set(s,i),null==(o=this._domElement)||o.addEventListener(s,i,{once:!0})}else if("complete"===s){let i=r(s);this._player.addEventListener(s,i),this._playerListeners.set(s,i)}else if("show"===s){let i=r(s);this._player.addIntersectionObserver({callbackOnIntersect:o=>{o>0&&(100!==o&&this._onShowPrevValue!==o&&i(),this._onShowPrevValue=o)},threshold:[]}),this._domListeners.set("visibilityChange",i)}}})}subscribe(i){throw(0,l.h)(i.toString())}_transformToXStateSchema(i){var o,s,c;let f=new Map;for(let d of i){let i={},p={};if(p.id=d.descriptor.id,"u">typeof d.descriptor.initial&&(p.initial=d.descriptor.initial),"u">typeof d){let f=d.states;for(let d in f)if("u">typeof f[d]&&f[d]){let p=f[d],y=p.playbackSettings,g=Object.keys(p).filter(i=>i.startsWith("on")),m={},x={};for(let i of g)if("u">typeof p[i]){let h=p[i];i===ts.after?x[h.ms]={target:null!=(o=null==h?void 0:h.state)?o:""}:i===ts.enter?m[(0,l.o)(ts,i)]={target:null!=(s=null==h?void 0:h.state)?s:""}:m[(0,l.o)(ts,i)]={target:null!=(c=null==h?void 0:h.state)?c:""}}i[d]={entry:()=>{!this._player.getAnimationInstance()||p.animationId&&p.animationId!==this._player.currentAnimationId?this._player.play(p.animationId,()=>({...h.d,...y})).then(()=>{this._updatePlaybackSettings(y)}).catch(i=>{(0,l.i)(`State machine error: ${i.message}`)}):this._updatePlaybackSettings(y)},exit:()=>{"u">typeof y.segments&&this._player.resetSegments(!1),"u">typeof y.playOnScroll&&this._player.stopPlayOnScroll()},on:m,after:x,meta:y}}}p.states=i,f.set(p.id,p)}return f}_handlePlaySegments(i){if("string"==typeof i.segments)this._player.goToAndPlay(i.segments,!0);else{let[o,s]=i.segments,c=o;0!==o&&o===s&&(c=o-1),0===o&&o===s?this._player.goToAndPlay(o,!0):this._player.playSegments([c,s],!0)}}_handlePlayOnScroll(i){let o=i.playOnScroll;if(i.segments&&"string"!=typeof i.segments){let s=i.segments;this._player.playOnScroll({threshold:o,segments:s})}else this._player.playOnScroll({threshold:o})}_updatePlaybackSettings(i){if(!this._player.getAnimationInstance())throw Error("Unable to update playbackSettings. Animations is not rendered yet.");"u">typeof i.autoplay&&(this._player.setAutoplay(i.autoplay),i.autoplay?this._player.play():this._player.pause()),"u">typeof i.direction&&this._player.setDirection(i.direction),"u">typeof i.intermission&&this._player.setIntermission(i.intermission),"u">typeof i.loop&&this._player.setLoop(i.loop),"u">typeof i.playMode&&this._player.setMode(i.playMode),"u">typeof i.speed&&this._player.setSpeed(i.speed),"u">typeof i.defaultTheme&&this._player.setDefaultTheme(i.defaultTheme),"u">typeof i.playOnScroll&&this._handlePlayOnScroll(i),i.segments&&this._handlePlaySegments(i),i.autoplay||this._player.pause()}_requiresDomElement(){if(!this._domElement)throw(0,l.h)("Requires a DOM element to attach events.")}}}}]);